import{Pane as g}from"https://cdn.jsdelivr.net/npm/tweakpane@4.0.1/dist/tweakpane.min.js";var u=["1-x-x^2+x^3","sin(x)","cos(x)","e^x"],i={equation:u[0],speed:40},s=new g({title:"MLP learns Taylor series"});s.registerPlugin(TweakpaneLatexPlugin);s.addBlade({view:"latex",content:`
This is trying to find the coefficients to the Taylor series up to the fourth power within [-2, 2] using simple backpropagation.
We need the data sampled to be enough such that it'll converge.
  `});s.addBinding(i,"equation").on("change",function(){e.data[0].fn=i.equation,e.data[1].scope={a:Math.random(),b:Math.random(),c:Math.random(),d:Math.random(),e:Math.random(),f:Math.random(),g:Math.random(),h:Math.random()},p()});var e={target:"#app",width:window.innerWidth,height:window.innerHeight,xAxis:{domain:[-3,3]},yAxis:{domain:[-2,2]},grid:!0,data:[{fn:i.equation},{scope:{a:Math.random(),b:Math.random(),c:Math.random(),d:Math.random(),e:Math.random(),f:Math.random(),g:Math.random(),h:Math.random()},fn:"a + b*x + c*x^2 + d*x^3 + e*x^4"}]};functionPlot(e);window.addEventListener("resize",function(n){e.width=n.target.innerWidth,e.height=n.target.innerHeight});var l={a:"1",b:"x",c:"x^2",d:"x^3",e:"x^4",f:"x^5",g:"x^6",h:"x^7"},o=-2,r=2;function p(){let n=setInterval(()=>{for(var a=e.data[1],h=e.data[0],d=0,t=o;t<r;t+=(r-o)/20)a.scope={...a.scope,x:t},d+=math.evaluate(`0.5 * (${a.fn} - (${h.fn}))^2`,a.scope);console.log("MSE: ",d);for(var m=.01,t=o;t<r;t+=(r-o)/20){a.scope={...a.scope,x:t};var f=math.evaluate(`(${a.fn} - (${h.fn}))`,a.scope);for(let c of Object.keys(l)){var x=math.evaluate(l[c],a.scope);a.scope[c]-=m*f*x}}d<1e-4&&(console.log("Minima reached"),clearInterval(n)),functionPlot(e)},i.speed)}p();
